<html>
  <head>
    <title>Calculateur d'équidistance</title>
  </head>
  <body>
    <h1>Calculateur d'équidistance</h1>
    <form>
      <label for="address1">Adresse 1:</label><br>
      <input type="text" id="address1" name="address1"><br>
      <label for="address2">Adresse 2:</label><br>
      <input type="text" id="address2" name="address2"><br><br>
      <button type="button" onclick="calculateMidpoint()">Calculer</button>
    </form> 
    <br>
    <div id="output"></div>    <script>
      // Remplacez YOUR_API_KEY par votre clé d'API Google Maps Geocoding
      var apiKey = 'AIzaSyCY5Ko2G-pybtFUctOe-FH0uWc7u-NcYr0';
      var lat1;
        var lng1;
        var lat2;
        var lng2;
        var lat;
        var lng;

    
      async function fetchUrl(url) {
        try {
            const response = await fetch(url, {
                method: 'GET',
            });
            const exam = await response.json();
            return exam;
        } catch (error) {
            console.error(error);
        }
    }

      async function calculateMidpoint() {
        // Récupérer les adresses saisies par l'utilisateur
        var address1 = document.getElementById('address1').value;
        var address2 = document.getElementById('address2').value;

        // Appeler l'API Google Maps Geocoding pour obtenir les coordonnées GPS des deux adresses
        var url1 = 'https://maps.googleapis.com/maps/api/geocode/json?address=' + encodeURIComponent(address1) + '&key=' + apiKey;
        var url2 = 'https://maps.googleapis.com/maps/api/geocode/json?address=' + encodeURIComponent(address2) + '&key=' + apiKey;
        
        // Envoyer une requête HTTP GET à l'API pour chaque adresse
        var response = await fetchUrl(url1);

        console.log("response: " + JSON.stringify(response))
        lat1 = response.results[0].geometry.location.lat;
        lng1 = response.results[0].geometry.location.lng;
        
        var response = await fetchUrl(url2);
        lat2 = response.results[0].geometry.location.lat;
        lng2 = response.results[0].geometry.location.lng;

        // Calculer les coordonnées GPS moyennes des deux adresses
        var lat = (parseFloat(lat1) + parseFloat(lat2)) / 2;
        var lng = (parseFloat(lng1) + parseFloat(lng2)) / 2;
        console.log("lat: " + lat);
        console.log("lng: " + lng);
        // Afficher les coordonnées GPS moyennes à l'utilisateur
        var url3 = 'https://maps.googleapis.com/maps/api/geocode/json?latlng=' + lat + ',' + lng +'&key=' + apiKey;
        var response = await fetchUrl(url3);
        address = response.results[0].formatted_address
        document.getElementById('output').innerHTML = 'Adresse du lieu équidistant : ' + address;
      };
      </script>
      </body>
</html>
